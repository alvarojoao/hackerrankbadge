{% load i18n admin_urls static admin_modify %}
{% load extra %}


<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.1.4/Chart.min.js"></script>
<style type="text/css">
	.container {
  width: 80%;
  margin: 15px auto;
}

#caption{
  margin-left: 25px;
}
</style>

<div class="container">
  <h2>Chart.js â€” Bar Chart Demo</h2>
  <div>
    <canvas id="myChart"></canvas>
  </div>
  <p id="caption">The chart is displaying apples & oranges</p>
</div>
<script type="text/javascript">
	var ctx = document.getElementById("myChart").getContext('2d');

var original = Chart.defaults.global.legend.onClick;
Chart.defaults.global.legend.display = false;
Chart.defaults.global.tooltips.enabled = false;

Chart.defaults.global.legend.onClick = function(e, legendItem) {
  update_caption(legendItem);
  original.call(this, e, legendItem);
};

var myChart = new Chart(ctx, {
  type: 'bar',
  data: {
    labels: {% autoescape off %}{{data|unzip:0}}{% endautoescape %},
    datasets: [{
      label: 'submisions',
      backgroundColor: "rgba(153,255,51,1)",
      data: {{data|unzip:1|toint}},
    }]
  }
});

var labels = {
  "apples": true,
  "oranges": true
};

var caption = document.getElementById("caption");

var update_caption = function(legend) {
  labels[legend.text] = legend.hidden;

  var selected = Object.keys(labels).filter(function(key) {
    return labels[key];
  });

  var text = selected.length ? selected.join(" & ") : "nothing";

  caption.innerHTML = "The chart is displaying " + text;
};
</script>